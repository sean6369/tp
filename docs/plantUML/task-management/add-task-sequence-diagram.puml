@startuml AddTaskSequenceDiagram
title FlowCLI: add-task Sequence

actor User
participant "FlowCLI Main" as CLI
participant "CommandParser" as Parser
participant "AddCommand" as AddCmd
participant "CommandContext" as Ctx
participant "Projects Model" as Projects
participant "Target Project" as Project
participant "UI" as UI

User -> CLI: add-task 1 Write project spec --priority high --deadline 2025-12-25
CLI -> Parser: parse(...)
Parser --> CLI: AddCommand

CLI -> AddCmd: execute(Ctx)

AddCmd -> Ctx: getProjects(), getUi()
Ctx --> AddCmd: Projects, UI

AddCmd -> Projects: getProjectByIndex(projectIndex)

alt invalid project index
    Projects --> AddCmd: IndexOutOfRangeException
    AddCmd --> CLI: IndexOutOfRangeException
    CLI -> UI: showError("Invalid project index")
else valid project
    Projects --> AddCmd: Project
    AddCmd -> Project: addTask(taskDesc, deadline, priority)
    Project --> AddCmd: updated tasks
    AddCmd -> UI: showAddedTask(Project)
    AddCmd --> CLI: success
end

@enduml
