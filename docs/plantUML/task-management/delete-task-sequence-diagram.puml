@startuml DeleteTaskSequenceDiagram
title FlowCLI: delete-task Sequence

actor User
participant "FlowCLI Main" as CLI
participant "CommandParser" as Parser
participant "DeleteTaskCommand" as DeleteCmd
participant "CommandContext" as Ctx
participant "Projects Model" as Projects
participant "Target Project" as Project
participant "UI" as UI

User -> CLI: delete-task 1 3
CLI -> Parser: parse(...)
Parser --> CLI: DeleteTaskCommand

CLI -> DeleteCmd: execute(Ctx)

DeleteCmd -> Ctx: getProjects(), getUi()
Ctx --> DeleteCmd: Projects, UI

DeleteCmd -> Projects: getProjectByIndex(projectIndex)

alt invalid project index
    Projects --> DeleteCmd: IndexOutOfRangeException
    DeleteCmd --> CLI: IndexOutOfRangeException
    CLI -> UI: showError("Invalid project index")
else valid project
    Projects --> DeleteCmd: Project
    DeleteCmd -> Project: getTask(taskIndex)

    alt task index out of range
        Project --> DeleteCmd: IndexOutOfRangeException
        DeleteCmd --> CLI: IndexOutOfRangeException
        CLI -> UI: showError("Invalid task index")
    else task found
        Project --> DeleteCmd: Task
        DeleteCmd -> Project: deleteTask(taskIndex)
        Project --> DeleteCmd: deletedTask
        DeleteCmd -> UI: showDeletedTask(Project, deletedTask)
        DeleteCmd --> CLI: success
    end
end

@enduml
