@startuml Command Processing Sequence Diagram

actor User
participant ":ConsoleUi" as ConsoleUi
participant ":CommandHandler" as CommandHandler
participant ":InteractivePromptHandler" as InteractivePromptHandler
participant ":CommandFactory" as CommandFactory
participant ":Command" as Command

User -> ConsoleUi: enters command (e.g., "add")
activate ConsoleUi
ConsoleUi -> CommandHandler: resolveCommand(input)
activate CommandHandler
CommandHandler -> CommandHandler: parse command type
activate CommandHandler
CommandHandler --> CommandHandler
deactivate CommandHandler

alt Interactive Mode Required
    CommandHandler -> InteractivePromptHandler: handleInteractiveCommand()
    activate InteractivePromptHandler
    InteractivePromptHandler -> User: prompt for project selection
    User -> InteractivePromptHandler: selects project
    InteractivePromptHandler -> User: prompt for description
    User -> InteractivePromptHandler: enters description
    InteractivePromptHandler -> User: prompt for priority
    User -> InteractivePromptHandler: selects priority
    InteractivePromptHandler -> User: prompt for deadline
    User -> InteractivePromptHandler: enters deadline
    InteractivePromptHandler --> CommandHandler: return constructed args
    deactivate InteractivePromptHandler
else Normal Mode
    CommandHandler -> CommandHandler: parse arguments normally
    activate CommandHandler
    CommandHandler --> CommandHandler
    deactivate CommandHandler
end

CommandHandler -> CommandFactory: createCommand(type, args)
activate CommandFactory
create Command
CommandFactory -> Command: new Command(args)
activate Command
CommandFactory --> CommandHandler: return Command
deactivate CommandFactory
CommandHandler -> Command: execute()
Command -> ConsoleUi: return result
deactivate Command
destroy Command
deactivate CommandHandler
ConsoleUi --> User: display result
deactivate ConsoleUi

@enduml